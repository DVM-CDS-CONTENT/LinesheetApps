<style>
         @font-face {
                  font-family: 'CPNRegular';
                  src: url('./font/CPN-Regular.ttf');
         }

         @font-face {
                  font-family: 'CPNBold';
                  src: url('./font/CPN-Bold.ttf');
         }

         @font-face {
                  font-family: 'CPNBoldCondensed';
                  src: url('./font/CPN-BoldCondensed.ttf');
         }

         body {
                  background: #C5C6D6;
                  align-items: center;
                  box-sizing: border-box;


         }

         .clean_page {
                  font-family: 'CPNRegular';
                  font-size: 15px;
                  font-weight: 500;
                  color: #0c1f3e;
         }

         .nav_input {
                  height: 40px;
                  left: 0px;
                  top: 76px;
                  background: #FFFFFF;
                  border: 1px solid rgba(233, 233, 233, 0.88);
                  box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.05);
                  display: flex;


         }

         .box_input {

                  justify-self: start;

         }

         .head_card_file {
                  text-align: left;
                  border: 0x solid #D1D5DB;
                  border-radius: 5px 5px 0 0;
                  background-color: #EEEEEE;
                  padding: 1px;

         }

         .card_file {
                  text-align: left;
                  border: 0px solid #D1D5DB;
                  border-radius: 0 0 5px 5px;
                  background-color: #ffffff;
                  padding: 1px;
                  justify-content: center;
         }

         .head_group_name {
                  text-align: left;
                  border: 0x solid #D1D5DB;
                  border-radius: 5px 5px 0 0;
                  background-color: #EEEEEE;
                  padding: 2%;
         }

         input.form-control {
                  height: 26px;
         }

         .text_input {
                  display: inline-block;
                  white-space: nowrap;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  max-width: 100%;
                  /* Adjust the max-width if needed */
         }
</style>
<div class="clean_page">
         <div class="nav_input col p-2 ">
                  <div class="box_input">
                           <input type="file" id="myFile" accept=".xlsx, .xlsm" />
                  </div>
         </div>

         <div class="container-fluid"">
         <div class=" row mb-3 text-center">
                  <div class="col-4">
                           <div class="container p-2">
                                    <div class="row head_card_file">
                                             <div class="col-6 p-1">
                                                      <span style="padding-left: 15px;">File informations</span>
                                             </div>
                                             <div class="col-6 p-1 text-end">
                                                      <span style="padding-right: 15px;" class="text_input"
                                                               id="name_file">No file selected</span>
                                             </div>
                                    </div>
                                    <div class="row card_file">
                                             <div class="row  p-1 mt-2">
                                                      <div class="col-4" style="display: grid;">
                                                               <span>Brand name</span>
                                                      </div>
                                                      <div class="col-8">
                                                               <input type="text" id="brand_name" class="form-control"
                                                                        placeholder="">
                                                      </div>
                                             </div>
                                             <div class="row p-1">
                                                      <div class="col-4" style="display: grid;">
                                                               <span>Total SKUs</span>
                                                      </div>
                                                      <div class="col-8">
                                                               <input type="text" id="total_sku" class="form-control"
                                                                        placeholder="">
                                                      </div>
                                             </div>
                                             <div class="row p-1">
                                                      <div class="col-4" style="display: grid;">
                                                               <span>Sale Channel</span>
                                                      </div>
                                                      <div class="col-8">
                                                               <input type="text" id="sale_channel" class="form-control"
                                                                        placeholder="">
                                                      </div>
                                             </div>
                                             <div class="row p-1">
                                                      <div class="col-4" style="display: grid;">
                                                               <span>Production type</span>
                                                      </div>
                                                      <div class="col-8">
                                                               <input type="text" id="production_type"
                                                                        class="form-control" placeholder="">
                                                      </div>
                                             </div>
                                             <div class="row p-1">
                                                      <div class="col-4" style="display: grid;">
                                                               <span>Template</span>
                                                      </div>
                                                      <div class="col-8">
                                                               <input type="text" id="tempate" class="form-control"
                                                                        placeholder="">
                                                      </div>
                                             </div>
                                             <div class="row p-1">
                                                      <div class="col-4" style="display: grid;">
                                                               <span>Store</span>
                                                      </div>
                                                      <div class="col-8">
                                                               <input type="text" id="store" class="form-control"
                                                                        placeholder="">
                                                      </div>
                                             </div>
                                             <div class="row">
                                                      <div class="col-md-4 offset-md-8 text-end p-2"
                                                               style="font-size: 12px;" id="other_information">
                                                               <a href="#">Other information</a>
                                                      </div>
                                             </div>
                                    </div>

                           </div>


                           <div class="row">

                                    <div class="col-5">

                                             <div class="container" style="padding-left: 8px;">

                                                      <div class="row head_group_name ">
                                                               <div class="col">
                                                                        <span>Model</span>
                                                               </div>
                                                      </div>
                                                      <div class="row card_file">
                                                               <div class="row p-1">
                                                                        <div class="col">
                                                                                 <input type="text" id="list_model"
                                                                                          class="form-control"
                                                                                          placeholder="">
                                                                        </div>
                                                               </div>
                                                      </div>
                                             </div>
                                    </div>
                                    <div class="col-7">
                                             <div class="container" style="padding-right: 8px; padding-left: 0;">

                                                      <div class="row head_group_name">
                                                               <div class="col">
                                                                        <span>Product</span>
                                                               </div>
                                                               <div class="col-4">
                                                                        <span
                                                                                 style="font-size: 12px; color: #898989; text-align: left;">all
                                                                                 SKU selected</span>
                                                               </div>
                                                      </div>
                                                      <div class="row card_file">
                                                               <div class="row p-1">
                                                                        <div class="col">
                                                                                 <input type="text" id="list_product"
                                                                                          class="form-control"
                                                                                          placeholder="">
                                                                        </div>
                                                               </div>
                                                      </div>
                                             </div>
                                    </div>



                           </div>
                  </div>
                  <div class="col-8" style="background-color: #ffffff; height: 100vh; ">
                           <div class="container" style="margin-left: 60px;">
                                    <nav aria-label="breadcrumb"
                                             style="--bs-breadcrumb-divider: '>'; padding-top: 40px; padding-bottom: 10px;font-size: 12px; font-weight: bold;">
                                             <ol class="breadcrumb breadcrumb-chevron p-2">
                                                      <li class="breadcrumb-item active" aria-current="page">
                                                               Import
                                                      </li>
                                                      <li class="breadcrumb-item">
                                                               <a class="link-body-emphasis fw-bold text-decoration-none"
                                                                        href="#" style="color: #A6192E;">Linesheet
                                                                        validate</a>
                                                      </li>
                                             </ol>
                                    </nav>

                                    <div class="row">
                                             <div class="col"
                                                      style="text-align: left; list-style-type: none; padding-left: 20px;">
                                                      <stong style="font-size:24px; font-weight: bold;">Linesheet
                                                               validation</stong><br>
                                                      <small style="font-size:12px;">Summary of Linesheet
                                                               validation</small>
                                             </div>
                                    </div>
                                    <div class="row" style="padding-top: 30px;">
                                             <div class="col py-5"
                                                      style="text-align: left; list-style-type: none; padding-left: 20px; ">
                                                      <div style="display: flex; align-items: center; margin-bottom: 10px;"
                                                               id="equal_count">
                                                               <ion-icon name="checkmark-circle-outline"
                                                                        style="font-size: 22px; color: #3ECC72;"
                                                                        id="icon"></ion-icon>
                                                               <span style="margin-left: 10px;">validate number of sku
                                                                        equal
                                                                        with count of sku in Linesheet</span>
                                                      </div>
                                                      <div style="display: flex; align-items: center; margin-bottom: 10px;"
                                                               id="equal_count">
                                                               <ion-icon name="checkmark-circle-outline"
                                                                        style="font-size: 22px; color: #3ECC72;"
                                                                        id="icon"></ion-icon>
                                                               <span style="margin-left: 10px;">validate size less than
                                                                        20 incase size standard is US or UK</span>
                                                      </div>
                                                      <div style="display: flex; align-items: center; margin-bottom: 10px;"
                                                               id="count_charecter">
                                                               <ion-icon name="checkmark-circle-outline"
                                                                        style="font-size: 22px; color: #3ECC72;"
                                                                        id="icon"></ion-icon>
                                                               <span style="margin-left: 10px;">validate count of
                                                                        charecter in product name meet with guideline
                                                                        (maximun 100 charecther)</span>
                                                      </div>
                                                      <div style="display: flex; align-items: center; margin-bottom: 10px;"
                                                               id="check_typefile">
                                                               <ion-icon name="checkmark-circle-outline"
                                                                        style="font-size: 22px; color: #3ECC72;"
                                                                        id="icon"></ion-icon>
                                                               <span style="margin-left: 10px;">validate type of file is
                                                                        XLSM</span>
                                                      </div>
                                                      <div style="display: flex; align-items: center; margin-bottom: 10px;"
                                                               id="check_dropdown">
                                                               <ion-icon name="checkmark-circle-outline"
                                                                        style="font-size: 22px; color: #3ECC72;"
                                                                        id="icon"></ion-icon>
                                                               <span style="margin-left: 10px;">validate dropdown is
                                                                        available on system</span>
                                                      </div>
                                             </div>
                                    </div>
                                    <div class="row">
                                             <div class="col py-5"
                                                      style="text-align: left; list-style-type: none; padding-left: 20px;">
                                                      <div
                                                               style="display: flex; align-items: center; margin-bottom: 10px;">
                                                               <ion-icon name="download-outline"
                                                                        style="font-size: 22px;"></ion-icon>
                                                               <a href="#"
                                                                        class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"
                                                                        style="margin-left: 10px;"
                                                                        id="dowload_linesheet">Download Linesheet
                                                                        with full report</a>
                                                      </div>
                                                      <div
                                                               style="display: flex; align-items: center; margin-bottom: 10px;">
                                                               <ion-icon name="create-outline"
                                                                        style="font-size: 22px;"></ion-icon>
                                                               <a href="#"
                                                                        class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"
                                                                        style="margin-left: 10px;"
                                                                        id="edit_linesheet">Edit linesheet with
                                                                        full report</a>
                                                      </div>
                                                      <div style="display: flex; align-items: center;">
                                                               <ion-icon name="open-outline"
                                                                        style="font-size: 22px;"></ion-icon>
                                                               <a href="#"
                                                                        class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"
                                                                        style="margin-left: 10px;" id="open_excel">Open
                                                                        in excel
                                                               </a>
                                                      </div>
                                             </div>

                                    </div>
                           </div>
                  </div>
         </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    // เมื่อผู้ใช้เลือกไฟล์
    $("#myFile").change(function() {
      var file = $(this).prop("files")[0];
      var formData = new FormData();
      formData.append("file", file);
      
      // ส่งไฟล์ไปยังเซิร์ฟเวอร์ Python
      $.ajax({
        url: "/validate_file",
        type: "POST",
        data: formData,
        contentType: false,
        processData: false,
        success: function(response) {
          // ดำเนินการตามการตอบกลับจากเซิร์ฟเวอร์
          console.log(response);
        },
        error: function(xhr, status, error) {
          console.error(error);
        }
      });
    });
  });
</script>
<!-- <script>
         var PythonShell = ''

         var { PythonShell } = require('python-shell');
         // const  {DataTable}= require('datatables.net-dt');
         var XLSX = require('xlsx');
         var path = require('path')

         document.getElementById("myFile").addEventListener("change", function (event) {
                  var selectedFile = event.target.files[0];
                  var nameSpan = document.getElementById("name_file");
                  var brandNameInput = document.getElementById("brand_name");
                  var equal_count = document.getElementById("equal_count");

                  if (selectedFile) {
                           nameSpan.textContent = selectedFile.name;
                           var filename = selectedFile.name;

                           console.log("file:", filename);
                           console.log("ขนาดไฟล์:", selectedFile.size, "bytes");
                           console.log("ประเภทไฟล์:", selectedFile.type);

                           brandNameInput.value = filename; 
                           total_skuInput.value = filename; 
                           
                  //          var options = {
                  //                   args: [filename]
                  //          };

                  //          var PythonShell = require('python-shell');
                  //          var path = require('path');
                  //          var scriptPath = path.join(__dirname, 'page/linesheet/convertor/f_validate.py');

                  //          PythonShell.run(scriptPath, options, function (err) {
                  //                   if (err) {
                  //                            console.error('An error occurred while running the Python script:', err);
                  //                   } else {
                  //                            console.log('Python script executed successfully');
                  //                   }
                  //          });
                  // } else {
                  //          nameSpan.textContent = "No file selected";
                  //          brandNameInput.value = ""; // Clear the input field if no file is selected
                  }
         });

</script> -->